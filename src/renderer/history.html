<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browsing History - Browzer</title>
    <link rel="stylesheet" href="history.css">
    <script>
        // Dynamically load CSS with absolute path if needed
        (function() {
            // Check if styles are loaded
            const styles = document.styleSheets;
            let stylesLoaded = false;
            
            for (let i = 0; i < styles.length; i++) {
                try {
                    // If we can access rules, the stylesheet is loaded
                    if (styles[i].cssRules && styles[i].cssRules.length > 0) {
                        stylesLoaded = true;
                        break;
                    }
                } catch (e) {
                    // Cross-origin stylesheet, ignore
                }
            }
            
            if (!stylesLoaded) {
                console.log('[History] Styles not loaded, attempting to load with absolute path');
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = window.location.href.substring(0, window.location.href.lastIndexOf('/')) + '/history.css';
                document.head.appendChild(link);
            }
        })();
    </script>
</head>
<body class="history-page">
    <div class="history-container">
        <div class="history-header">
            <h1>ðŸ“š Browsing History</h1>
        </div>
        
        <div class="history-stats" id="historyStats" style="display: none;">
            <div class="history-stat">
                <div class="history-stat-value" id="totalItems">0</div>
                <div class="history-stat-label">Total Items</div>
            </div>
            <div class="history-stat">
                <div class="history-stat-value" id="todayItems">0</div>
                <div class="history-stat-label">Today</div>
            </div>
            <div class="history-stat">
                <div class="history-stat-value" id="weekItems">0</div>
                <div class="history-stat-label">This Week</div>
            </div>
        </div>
        
        <div class="history-controls">
            <div class="history-search-box">
                <input type="text" id="searchInput" placeholder="Search history...">
            </div>
            <button class="history-clear-btn" id="clearHistoryBtn">Clear All History</button>
        </div>
        
        <div class="history-list" id="historyList">
            <div class="history-loading" id="loadingMessage">
                <div class="loading-spinner"></div>
                Loading your browsing history...
            </div>
        </div>
    </div>

    <script src="history.js"></script>
    <script>
        // Dynamically load JS with absolute path if needed
        (function() {
            // Check if the history manager is initialized after a short delay
            setTimeout(function() {
                if (!window.historyManager) {
                    console.log('[History] historyManager not found, attempting to load script with absolute path');
                    const script = document.createElement('script');
                    script.src = window.location.href.substring(0, window.location.href.lastIndexOf('/')) + '/history.js';
                    document.body.appendChild(script);
                    
                    // Initialize historyManager after script loads
                    script.onload = function() {
                        console.log('[History] Script loaded with absolute path, initializing historyManager');
                        if (typeof HistoryPageManager === 'function') {
                            window.historyManager = new HistoryPageManager();
                        }
                    };
                }
            }, 500);
        })();
    </script>
</body>
</html>